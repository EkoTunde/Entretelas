{% extends 'base.html' %}

{% block content %}

<style type="text/css">
    .d {
        border: 3px solid;
        padding: 5px;
        margin-bottom: 5px;
    }

    .state {
        margin: 5px;
        padding: 5px;
    }
</style>


<!-- TITULOS -->
<div class="d">
    <h1>Pedido N.° {{ order.id }}</h1>
</div>
{% load tz %}<p>Creado el {{ order.creation_date|timezone:"America/Buenos_Aires" }}</p>
<h5>Estado ->
    {% if order.state == "NE" %}
    <span class="state" style="background-color: #E33142; color: #fff;">
        {% elif order.state == "ER" %}
        <span class="state" style="background-color: #FBBF09;">
            {% elif order.state == "AC" %}
            <span class="state" style="background-color: #198754; color: #fff;">
                {% elif order.state == "MK" %}
                <span class="state" style="background-color: #106DF9; color: #fff;">
                    {% elif order.state == "FI" %}
                    <span class="state" style="background-color: #6C757D; color: #fff;">
                        {% endif %}
                        {{ order.get_state_display }}
                    </span>
</h5>
<hr>


<!-- DATOS CLIENTES -->
<h5>Datos del/de la cliente <span><button>Editar</button></span></h5>
<p><b>Nombre y apellido:</b> {{ order.customer_first_name }} {{ order.customer_last_name }}</p>
<p><b>Email:</b> <a href="mailto:{{ order.customer_email }}">{{ order.customer_email }}</a></p>
<p><b>Teléfono:</b> {{ order.customer_tel }}</p>
<hr>


{% load currency_extras %}

<!-- PRODUCTOS -->
<h5>Productos</h5>
{% if items|length > 0 %}
<div>
    <table class="table table-hover w-auto">
        <thead class=" table-light">
            <tr>
                <th scope="col"></th>
                <th scope="col">Concepto</th>
                <th scope="col">Valor</th>
                <th scope="col">Unidades</th>
                <th scope="col">Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            {% include 'orders/snippets/item_table_item.html' with item=item %}
            {% endfor %}
        </tbody>
    </table>
    <p><b>Subtotal:</b> {{ items_total|currencier }}</p>
</div>
{% else %}
<p>Aun no agregaste ningún producto a la lista. Agregá uno haciendo click <a
        href="{% url 'orders:order-add-item' id=order.id %}">aquí</a>.
</p>
{% endif %}
<hr>


<!-- TELAS -->
<h5>Telas</h5>
{% if fabrics|length > 1 %}
<div>
    <table class="table table-hover w-auto">
        <thead class=" table-light">
            <tr>
                <th scope="col"></th>
                <th scope="col">Concepto</th>
                <th scope="col">Precio por metro</th>
                <th scope="col">Metros</th>
                <th scope="col">Total</th>
            </tr>
        </thead>
        <tbody>
            {% for fabric in fabrics %}
            {% include 'orders/snippets/item_table_fabric.html' with fabric=fabric %}
            {% endfor %}
        </tbody>
    </table>
    <p><b>Subtotal:</b> {{ fabrics_total|currencier }}</p>
</div>
{% else %}
<p>Aun no gastaste nada en telas. Agregá un gasto haciendo click <a href="#">aquí</a>.</p>
{% endif %}
<hr>


<!-- SALDOS -->
<p><b>Total:</b> {{ total|currencier }}</p>
<p>
    <b>Abonado:</b> {{ payments_total|currencier }}
    <button>Ver pagos</button>
</p>
<p><b>Saldo restante:</b> {{ left_balance|currencier }}</p>
<hr>


<!-- ACCIONES -->
<div>
    {% if order.expiration_date %}
    Fecha de vencimiento: {{ order.expiration_date|timezone:'America/Buenos_Aires' }}
    <button class="btn btn-primary">Reimprimir presupuesto</button>
    {% else %}
    <button class="btn btn-primary">Imprimir presupuesto</button>
    {% endif %}
</div>

<p>{{ order.expiraton_date }}</p>


{% endblock %}